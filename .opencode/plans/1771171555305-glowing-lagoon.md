# Plan: Responsive Dialog (Dialog on desktop, Drawer on mobile)

## Strategy

Create `ResponsiveDialog` and `ResponsiveAlertDialog` compound components that use React context + `useIsMobile()` to delegate to Dialog or Drawer primitives. Each modal file then swaps imports -- form JSX stays unchanged.

## Phase 1: Create `ResponsiveDialog` compound component

**New file:** `packages/web/src/components/ui/responsive-dialog.tsx`

Context-based compound component exporting:

| Export | Desktop | Mobile |
|---|---|---|
| `ResponsiveDialog` | `<Dialog>` | `<Drawer>` |
| `ResponsiveDialogTrigger` | `<DialogTrigger>` | `<DrawerTrigger>` |
| `ResponsiveDialogContent` | `<DialogContent showCloseButton>` | `<DrawerContent>` with scrollable inner |
| `ResponsiveDialogBody` | `<div className="px-6 pt-6 pb-5">` | `<div className="px-4 overflow-y-auto">` |
| `ResponsiveDialogFooter` | `<><hr/><div class="flex justify-end px-6 py-4">` | `<DrawerFooter>` |
| `ResponsiveDialogClose` | `<DialogClose>` | `<DrawerClose>` |

Key details:
- `ResponsiveDialogContent` on desktop: `className="gap-0 p-0"` baked in (all 11 modals use this)
- `ResponsiveDialogContent` accepts additional `className` for sizing overrides (e.g., `max-w-3xl`)
- Mobile: `DrawerContent` already constrains to `max-h-[80vh]`, body gets `overflow-y-auto`
- SSR: `useIsMobile()` returns `false` initially -> defaults to desktop, which is wrapped in `ClientOnly` by existing `DialogContent`

## Phase 2: Create `ResponsiveAlertDialog` compound component

**New file:** `packages/web/src/components/ui/responsive-alert-dialog.tsx`

Same pattern but for AlertDialog semantics:

| Export | Desktop | Mobile |
|---|---|---|
| `ResponsiveAlertDialog` | `<AlertDialog>` | `<Drawer>` |
| `ResponsiveAlertDialogContent` | `<AlertDialogContent>` | `<DrawerContent>` |
| `ResponsiveAlertDialogHeader` | `<AlertDialogHeader>` | `<DrawerHeader>` |
| `ResponsiveAlertDialogTitle` | `<AlertDialogTitle>` | `<DrawerTitle>` |
| `ResponsiveAlertDialogDescription` | `<AlertDialogDescription>` | `<DrawerDescription>` |
| `ResponsiveAlertDialogFooter` | `<AlertDialogFooter>` | `<DrawerFooter>` |
| `ResponsiveAlertDialogAction` | `<AlertDialogAction>` | `<Button>` (no drawer action primitive) |
| `ResponsiveAlertDialogCancel` | `<AlertDialogCancel>` | `<DrawerClose>` wrapping `<Button variant="outline">` |

## Phase 3: Refactor 11 create modals

Each file: swap Dialog imports -> ResponsiveDialog, wrap form body in `ResponsiveDialogBody`, wrap footer in `ResponsiveDialogFooter`.

Files (all under `packages/web/src/features/`):
- `framework/create-framework.tsx`
- `control/create-control.tsx`
- `risk/create-risk.tsx`
- `evidence/create-evidence.tsx`
- `policy/create-policy.tsx`
- `audit/create-audit.tsx`
- `issue/create-issue.tsx`
- `assessment/create-template.tsx`
- `assessment/create-instance.tsx`
- `questioner/create-template.tsx` (special: `max-w-3xl`, multi-section body)
- `questioner/create-instance.tsx`

Pattern per file:
```diff
- import { Dialog, DialogContent, DialogTrigger } from "@/components/ui/dialog"
+ import { ResponsiveDialog, ResponsiveDialogContent, ResponsiveDialogTrigger, ResponsiveDialogBody, ResponsiveDialogFooter } from "@/components/ui/responsive-dialog"

# In form component:
- <DialogContent className="gap-0 p-0">
+ <ResponsiveDialogContent>
    <form>
-     <div className="px-6 pt-6 pb-5">
+     <ResponsiveDialogBody>
        {/* fields unchanged */}
-     </div>
-     <hr className="w-full" />
-     <div className="flex ... px-6 py-4">
+     </ResponsiveDialogBody>
+     <ResponsiveDialogFooter>
        <Button type="submit">Create</Button>
-     </div>
+     </ResponsiveDialogFooter>
    </form>
- </DialogContent>
+ </ResponsiveDialogContent>

# In wrapper component:
- <Dialog open={open} onOpenChange={...}>
-   <DialogTrigger asChild>
+ <ResponsiveDialog open={open} onOpenChange={...}>
+   <ResponsiveDialogTrigger asChild>
```

### questioner/create-template.tsx special handling
- Pass `className="max-w-3xl"` to `ResponsiveDialogContent`
- Wrap the multi-section body (name/desc div + "Questions" label + questions list + error) in single `ResponsiveDialogBody`
- `ResponsiveDialogBody` accepts className override for non-standard padding

## Phase 4: Refactor delete modal

**File:** `features/framework/delete-framework.tsx`

Swap AlertDialog imports -> ResponsiveAlertDialog equivalents. Structure stays the same.

## Verification

1. `bun scan:fix` -- must pass clean
2. Desktop: all 12 modals render as centered dialog (existing behavior)
3. Mobile (resize to <768px or device toolbar): all 12 modals render as bottom drawer with drag handle
4. Test questioner template specifically -- long form should scroll in drawer
5. Test delete framework -- drawer should be dismissible, action buttons work

## File summary

| Action | File |
|---|---|
| CREATE | `packages/web/src/components/ui/responsive-dialog.tsx` |
| CREATE | `packages/web/src/components/ui/responsive-alert-dialog.tsx` |
| EDIT | `packages/web/src/features/framework/create-framework.tsx` |
| EDIT | `packages/web/src/features/framework/delete-framework.tsx` |
| EDIT | `packages/web/src/features/control/create-control.tsx` |
| EDIT | `packages/web/src/features/risk/create-risk.tsx` |
| EDIT | `packages/web/src/features/evidence/create-evidence.tsx` |
| EDIT | `packages/web/src/features/policy/create-policy.tsx` |
| EDIT | `packages/web/src/features/audit/create-audit.tsx` |
| EDIT | `packages/web/src/features/issue/create-issue.tsx` |
| EDIT | `packages/web/src/features/assessment/create-template.tsx` |
| EDIT | `packages/web/src/features/assessment/create-instance.tsx` |
| EDIT | `packages/web/src/features/questioner/create-template.tsx` |
| EDIT | `packages/web/src/features/questioner/create-instance.tsx` |
